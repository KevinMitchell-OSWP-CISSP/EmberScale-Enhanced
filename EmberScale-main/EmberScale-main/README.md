<p align="center">
  <img src="assets/logo.png" alt="EmberScale AI logo" height="150">
</p>

# EmberScale AI for Ghidra
AI‑assisted reverse‑engineering tools for Ghidra (Jython). Two tiers, annual per‑seat licensing, Bring‑Your‑Own Anthropic API key (BYOK).

## Tiers and Pricing (Annual, per seat)
- **Pro — $199/year**: Read‑only analysis and triage inside Ghidra.
- **Autopilot (Dragontamer) — $449/year**: Everything in Pro plus batch write‑back (rename/retype, line comments, explanations).


---

## Included Tools by Tier

### Pro
- `EmberScale_QA_Lite.py` — one‑shot Q&A about the binary.
- `EmberScale_Single_Decompile.py` — targeted decompile of a function.
- `EmberScale-RE_Toolbox.py` — multi‑tool, read‑only analyst loop:
  - decompile, xrefs, callers/callees, disassembly window, signature, locals/params, basic blocks, string search, raw bytes, list functions.

### Autopilot (Dragontamer)
- Everything in **Pro**, plus:
- `EmberScale_Ghidra.py` — batch agent that proposes and applies rename/retype, line comments, and explanations across selections or ranges.

**Packaging (Option B)**: Per‑tier archives
- `EmberScale-Pro-vX.Y.Z.zip` (only Pro tools + license helper + docs)
- `EmberScale-Autopilot-vX.Y.Z.zip` (Pro tools + `EmberScale_Ghidra.py`)

---

## Why EmberScale is worth more than $500/year
These concrete, ROI‑driven reasons explain the pricing and the value:

1. **Time saved on rote work** — Batch rename/retype/comments/explanations. Even 5 hours/year saved at $100/hr clears $500; typical savings are higher.
2. **Daily triage acceleration** — Toolbox compresses pivots (xrefs, callers, blocks, strings) into one loop. 30 minutes/week ≈ 26 hours/year → $2,600 at $100/hr.
3. **Consistency across the codebase** — Style‑consistent names/types/explanations reduce rework and speed onboarding.
4. **Explain‑as‑you‑go** — Autogenerated function explanations reduce senior review time by enabling self‑service first‑pass understanding.
5. **Safer, auditable changes** — Dry‑runs, narrow ranges, and logs lower the risk of misapplied refactors under deadline.
6. **Built for Ghidra/Jython realities** — Java HTTPS fallback and Unicode‑safe prompts prevent setup churn and brittle failures.
7. **Works offline** — Signed, offline tokens fit lab/air‑gapped networks; optional check‑in refresh for connected teams.
8. **Scales with size** — The bigger the binary and team, the more the batch agent compounds throughput advantages.
9. **Predictable costs (BYOK)** — You own model usage; EmberScale delivers workflow acceleration and guardrails without metered lock‑in.
10. **Lower TCO than alternatives** — One missed deadline or a single week of engineer time dwarfs $500; EmberScale pays for itself quickly.

---

## Quick Install
1. Download the correct archive for your tier.
2. Unzip into a folder, e.g. `EmberScale-v1.3/`.
3. In Ghidra: **Script Manager → Manage Script Directories… → Add** that folder → **Refresh**.
4. Set your Anthropic key (BYOK):
   - Environment: `export ANTHROPIC_API_KEY=sk-ant-...`
   - Optional: `export ANTHROPIC_MODEL=claude-sonnet-4-20250514`
5. Activate license:
   - Paste your **license blob** into Preferences key `EMBERSCALE_LICENSE`, **or**
   - Set `EMBERSCALE_LICENSE_KEY` and `EMBERSCALE_LIC_URL` for online activation.

> The license helper `emberscale_license.py` verifies a signed JSON token (`tier`, `exp`), optionally machine‑bound. Offline by default; optional online check‑in refresh.

---

## Usage (Common Flows)

### Pro tier
- **QA Lite** (`EmberScale_QA_Lite.py`): Ask a natural‑language question about the binary and get an answer contextualized by function names and strings.
- **Single Decompile** (`EmberScale_Single_Decompile.py`): Request decompilation for a specific function (by name or address).
- **RE Toolbox** (`EmberScale-RE_Toolbox.py`): Open the toolbox and choose tasks like decompile, show xrefs, callers/callees, basic blocks, strings, bytes, or a disassembly window at an address.

### Autopilot (Dragontamer)
- **Batch Agent** (`EmberScale_Ghidra.py`): Select an address range or use the current selection; run actions:
  - `rename_retype` — suggest and apply better names and types.
  - `line_comments` — insert inline address‑annotated comments.
  - `explanation` — add a top‑level function explanation.

Start narrow (one or two functions), confirm results, then widen the range.

---

## Power Prompts (good starting points)
- “Map out what writes to `0x000B1C7C` and show the basic blocks of the callee that does the most writes.”
- “Decompile `FUN_000b0f54`, then list its callers and give me a short summary of each caller’s purpose based on xrefs/strings.”
- “Find strings containing `auth` and show xrefs → which functions are likely auth checks?”
- “At `0x000B1E6C`, show 8 instructions before and 16 after, and tell me if this is part of a bounds check.”
- “Give me the full signature + locals for `process_grid_pattern_copy`, and explain the role of each parameter.”

---

## Tool Comparison
| Aspect | Batch Agent (`EmberScale_Ghidra.py`) | `EmberScale_RE_Toolbox.py` | `EmberScale_Single_Decompile.py` |
| --- | --- | --- | --- |
| Purpose | Bulk clean‑up & annotation over many functions | Interactive analyst helper with multiple read‑only tools | Tiny helper to fetch a function’s decompilation |
| Writes to program? | Yes (renames, types, comments) | No (safe read‑only) | No |
| Scope | Selection or address range; iterates all functions | On‑demand, model calls tools as needed | On‑demand, one tool only |
| Tools/Actions | 3 actions: rename/retype, line comments, explanation | 9+ tools: decompile, xrefs, callers/callees, disasm window, signature, locals, basic blocks, strings, bytes, list funcs | 1 tool: decompile |
| Transport | `decyx.api` (patched/Jython‑safe; Java HTTPS fallback) | Java HTTPS (trust‑all) client | Java HTTPS (trust‑all) client |
| UX | Non‑interactive once started; batch | Menu + freeform prompt, iterative tool‑use | Single prompt, short loop |
| Cost/latency | Highest (many calls; big prompts) | Medium (depends on tool use) | Lowest |

---

## Security & Privacy
- Your model key is yours (BYOK). Keys are read from environment or saved in Ghidra Preferences.
- License tokens are verified locally with a public key; optional online check‑in is available.
- For sensitive networks, you can use air‑gapped mode with offline tokens only.

---

## Support
- Email support targets: 24–48 hours (Pro), faster targets for Autopilot.
- For license transfers, activation issues, or custom prompts/house style, contact support.

---

## Changelog
Releases are versioned as `vX.Y.Z`. See `CHANGELOG.md` in each package.

---

## Legal
Use is per‑seat under an EmberScale EULA (no redistribution, no reverse engineering, internal use only). Anthropic usage is billed separately by your provider.
"""
